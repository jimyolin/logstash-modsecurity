# Just a classic example

--ab674f55-A--
[17/Jan/2017:01:02:52 --0500] WH2zjH8AAQEAABU9En0AAAAC 10.10.10.1 61237 10.10.10.2 443
--ab674f55-B--
GET /index.php?exec=/bin/bash HTTP/1.1
Host: example.net:443
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:50.0) Gecko/20100101 Firefox/50.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Cookie: _ga=GA1.2.481774887.1484112315
Connection: keep-alive
Upgrade-Insecure-Requests: 1

--ab674f55-F--
HTTP/1.1 200 OK
Last-Modified: Sat, 14 May 2016 18:13:19 GMT
ETag: "a4f-532d1589be384"
Accept-Ranges: bytes
Content-Length: 2639
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive

--ab674f55-E--

--ab674f55-H--
Message: Warning. Matched phrase "bin/bash" at ARGS:exec. [file "/etc/apache2/owasp-modsecurity-crs/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf"] [line "448"] [id "932160"] [rev "1"] [msg "Remote Command Execution: Unix Shell Code Found"] [data "Matched Data: bin/bash found within ARGS:exec: /bin/bash"] [severity "CRITICAL"] [ver "OWASP_CRS/3.0.0"] [maturity "1"] [accuracy "8"] [tag "application-multi"] [tag "language-shell"] [tag "platform-unix"] [tag "attack-rce"] [tag "OWASP_CRS/WEB_ATTACK/COMMAND_INJECTION"] [tag "WASCTC/WASC-31"] [tag "OWASP_TOP_10/A1"] [tag "PCI/6.5.2"]
Message: Warning. Operator GE matched 5 at TX:anomaly_score. [file "/etc/apache2/owasp-modsecurity-crs/rules/REQUEST-949-BLOCKING-EVALUATION.conf"] [line "57"] [id "949110"] [msg "Inbound Anomaly Score Exceeded (Total Score: 5)"] [severity "CRITICAL"] [tag "application-multi"] [tag "language-multi"] [tag "platform-multi"] [tag "attack-generic"]
Message: Warning. Operator GE matched 5 at TX:inbound_anomaly_score. [file "/etc/apache2/owasp-modsecurity-crs/rules/RESPONSE-980-CORRELATION.conf"] [line "73"] [id "980130"] [msg "Inbound Anomaly Score Exceeded (Total Inbound Score: 5 - SQLI=0,XSS=0,RFI=0,LFI=0,RCE=5,PHPI=0,HTTP=0,SESS=0): Remote Command Execution: Unix Shell Code Found"] [tag "event-correlation"]
Stopwatch: 1484632972983651 7580 (- - -)
Stopwatch2: 1484632972983651 7580; combined=5477, p1=1046, p2=3617, p3=137, p4=338, p5=338, sr=43, sw=1, l=0, gc=0
Response-Body-Transformed: Dechunked
Producer: ModSecurity for Apache/2.9.0 (http://www.modsecurity.org/); OWASP_CRS/3.0.0.
Server: Apache/2.4.18 (Example)
Engine-Mode: "DETECTION_ONLY"

--ab674f55-Z--

# I had an issue where hardware actually made this request. It broke the logstash parse for logstash-modsecurity. Notice the lack of the protocol

--ab674f55-A--
[17/Jan/2017:01:02:52 --0500] WH2zjH8AAQEAABU9En0AAAAC 10.10.10.1 61237 10.10.10.2 443
--ab674f55-B--
GET /amIup

--ab674f55-F--
YES

--ab674f55-E--

--ab674f55-H--
Message: Warning. HTTP protocol violated/missing. [file "/etc/apache2/owasp-modsecurity-crs/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf"] [line "448"] [id "932160"] [rev "1"] [msg "Remote Command Execution: Unix Shell Code Found"] [severity "CRITICAL"] [ver "OWASP_CRS/3.0.0"] [maturity "1"] [accuracy "8"] [tag "application-multi"] [tag "language-shell"] [tag "platform-unix"] [tag "attack-rce"] [tag "OWASP_CRS/WEB_ATTACK/COMMAND_INJECTION"] [tag "WASCTC/WASC-31"] [tag "OWASP_TOP_10/A1"] [tag "PCI/6.5.2"]
Message: Warning. Operator GE matched 5 at TX:anomaly_score. [file "/etc/apache2/owasp-modsecurity-crs/rules/REQUEST-949-BLOCKING-EVALUATION.conf"] [line "57"] [id "949110"] [msg "Inbound Anomaly Score Exceeded (Total Score: 5)"] [severity "CRITICAL"] [tag "application-multi"] [tag "language-multi"] [tag "platform-multi"] [tag "attack-generic"]
Message: Warning. Operator GE matched 5 at TX:inbound_anomaly_score. [file "/etc/apache2/owasp-modsecurity-crs/rules/RESPONSE-980-CORRELATION.conf"] [line "73"] [id "980130"] [msg "Inbound Anomaly Score Exceeded (Total Inbound Score: 5 - SQLI=0,XSS=0,RFI=0,LFI=0,RCE=5,PHPI=0,HTTP=0,SESS=0): Remote Command Execution: Unix Shell Code Found"] [tag "event-correlation"]
Stopwatch: 1484632972983651 7580 (- - -)
Stopwatch2: 1484632972983651 7580; combined=5477, p1=1046, p2=3617, p3=137, p4=338, p5=338, sr=43, sw=1, l=0, gc=0
Response-Body-Transformed: Dechunked
Producer: ModSecurity for Apache/2.9.0 (http://www.modsecurity.org/); OWASP_CRS/3.0.0.
Server: Apache/2.4.18 (Example)
Engine-Mode: "DETECTION_ONLY"

--ab674f55-Z--
